{"version":3,"sources":["scripts/views/login/index.js","scripts/components/head/index.js"],"names":["mobileReg","codeReg","timer","num","Login","setMobile","val","code","state","value","setState","phoneFlag","test","loginFlag","setCode","mobile","receiveCode","setInterval","txt","toggle","clearInterval","axios","post","gotoLogin","then","res","data","type","history","push","sessionStorage","token","this","className","title","leftShow","style","marginTop","placeholder","clear","ref","el","onChange","disabled","inline","onClick","Component","Head","goBack","go","gotoSearch","props","rightShow","typeShow","mineShow","position","mode","icon","color","onLeftClick","rightContent","key","marginRight","right","top","fontSize","lineHeight","showAlert","alert","msg","alertInstance","text","onPress","console","log","setTimeout","close"],"mappings":"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","file":"static/js/17.aac2f009.chunk.js","sourcesContent":["import \"./index.scss\";\r\nimport { Head } from \"../../components/head\";\r\nimport { InputItem, List, Button, WhiteSpace } from \"antd-mobile\";\r\nimport { axios } from \"&\";\r\nimport { history } from \"&/history\";\r\nconst mobileReg = /^1(3|5|7|8|9)\\d{9}$/;\r\nconst codeReg = /^\\d{4}$/;\r\nlet timer = null;\r\nconst num = 60;\r\nexport default class Login extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      phoneFlag: false,\r\n      loginFlag: false,\r\n      txt: \"获取验证码\",\r\n      num,\r\n      toggle: true\r\n    };\r\n  }\r\n  setMobile = val => {\r\n    const code = this.code.state.value;\r\n    this.setState({\r\n      phoneFlag: mobileReg.test(val),\r\n      loginFlag: mobileReg.test(val) && codeReg.test(code)\r\n    });\r\n  };\r\n  setCode = val => {\r\n    this.setState({\r\n      loginFlag: mobileReg.test(this.mobile.state.value) && codeReg.test(val)\r\n    });\r\n  };\r\n  receiveCode = () => {\r\n    timer = setInterval(() => {\r\n      if (this.state.num > 0) {\r\n        this.state.num--;\r\n        this.setState({\r\n          num: this.state.num,\r\n          txt: `还剩${this.state.num}S`,\r\n          phoneFlag: false,\r\n          toggle: false\r\n        });\r\n      } else {\r\n        this.setState({\r\n          num,\r\n          txt: \"获取验证码\",\r\n          phoneFlag: true,\r\n          toggle: true\r\n        });\r\n        clearInterval(timer);\r\n      }\r\n    }, 1000);\r\n    axios.post(\"/react/sendCode\", {\r\n      mobile: this.mobile.state.value\r\n    });\r\n  };\r\n  gotoLogin = () => {\r\n    axios\r\n      .post(\"/react/checkCode\", {\r\n        mobile: this.mobile.state.value,\r\n        code: this.code.state.value\r\n      })\r\n      .then(res => {\r\n        if (!!res.data.type) {\r\n          history.push(\"/index/mine\");\r\n          sessionStorage.token = res.data.token;\r\n          sessionStorage.mobile = this.mobile.state.value\r\n        } else {\r\n          sessionStorage.token = \"\";\r\n        }\r\n      });\r\n  };\r\n  componentWillUnmount(){\r\n      clearInterval(timer)\r\n  }\r\n  render() {\r\n    const { phoneFlag, loginFlag, txt, toggle } = this.state;\r\n    return (\r\n      <div className=\"loginView\">\r\n        <Head title=\"登录\" leftShow={true}></Head>\r\n        <List style={{ marginTop: \"3.5rem\" }}>\r\n          <InputItem\r\n            placeholder=\"请输入正确的手机号\"\r\n            type=\"tel\"\r\n            clear\r\n            ref={el => (this.mobile = el)}\r\n            onChange={this.setMobile}\r\n            disabled={!toggle}\r\n          />\r\n          <InputItem\r\n            type=\"number\"\r\n            placeholder=\"请输入验证码\"\r\n            clear\r\n            ref={el => (this.code = el)}\r\n            onChange={this.setCode}\r\n          />\r\n          <Button\r\n            inline\r\n            className=\"l-btn\"\r\n            onClick={this.receiveCode}\r\n            disabled={!phoneFlag}\r\n          >\r\n            {txt}\r\n          </Button>\r\n          <WhiteSpace />\r\n        </List>\r\n        <Button onClick={this.gotoLogin} disabled={!loginFlag}>\r\n          登录\r\n        </Button>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import \"./index.scss\";\r\nimport { NavBar, Icon, Modal } from \"antd-mobile\";\r\nimport { history } from \"&/history\";\r\nimport {Redirect} from \"react-router-dom\"\r\n\r\nexport class Head extends Component {\r\n  goBack = leftShow => {\r\n    if (leftShow) {\r\n      history.go(-1);\r\n    }\r\n  };\r\n  gotoSearch = () => {\r\n    history.push(\"/search\");\r\n  };\r\n  render() {\r\n    const { title, leftShow, rightShow, typeShow, mineShow } = this.props;\r\n    return (\r\n      <NavBar\r\n        style={{ position: \"relative\" }}\r\n        mode=\"light\"\r\n        icon={leftShow && <Icon style={{color:\"#333\"}} type=\"left\" />}\r\n        onLeftClick={() => this.goBack(leftShow)}\r\n        rightContent={[\r\n          rightShow && (\r\n            <Icon\r\n              key=\"0\"\r\n              type=\"search\"\r\n              style={{ marginRight: \"0.2rem\", color: \"#333\" }}\r\n              onClick={this.gotoSearch}\r\n            />\r\n          )\r\n        ]}\r\n      >\r\n        {title}\r\n        {typeShow && (\r\n          <p\r\n            style={{\r\n              position: \"absolute\",\r\n              right: \"0\",\r\n              top: \"0.3rem\",\r\n              fontSize: \"0.3rem\",\r\n              marginRight: \"0.25rem\",\r\n              lineHeight: 1\r\n            }}\r\n          >\r\n            只看评论\r\n          </p>\r\n        )}\r\n        {mineShow && (\r\n          <p\r\n            style={{\r\n              color: \"#333333\",\r\n              position: \"absolute\",\r\n              right: \"0\",\r\n              top: \"0.3rem\"\r\n            }}\r\n          >\r\n            <i\r\n              className=\"iconfont icon-biaoqing\"\r\n              onClick={() =>\r\n                showAlert(\r\n                  \"夜间模式\",\r\n                  \"称为会员后，即可使用带有暗黑主题的夜间模式，分享暗色主题卡片，以及更多高级功能。\"\r\n                )\r\n              }\r\n            ></i>\r\n            <i\r\n              className=\"iconfont icon-xingtaiduICON_sousuo--\"\r\n              onClick={() =>\r\n                showAlert(\r\n                  \"快速搜索\",\r\n                  \"称为会员后，即可快速搜索自己创建搜索自己创建/收藏的卡片，以及使用更多高级功能。\"\r\n                )\r\n              }\r\n            ></i>\r\n            <i\r\n              className=\"iconfont icon-shezhi\"\r\n              onClick={() =>history.push(\"/fit\")}\r\n            ></i>\r\n          </p>\r\n        )}\r\n      </NavBar>\r\n    );\r\n  }\r\n}\r\n\r\nconst alert = Modal.alert;\r\nconst showAlert = (title, msg) => {\r\n  const alertInstance = alert(title, msg, [\r\n    { text: \"取消\", onPress: () => console.log(\"cancel\"), style: \"default\" },\r\n    { text: \"了解会员\", onPress: () => console.log(\"ok\") }\r\n  ]);\r\n  setTimeout(() => {\r\n    // 可以调用close方法以在外部close\r\n    console.log(\"auto close\");\r\n    alertInstance.close();\r\n  }, 500000);\r\n};\r\n"],"sourceRoot":""}