{"version":3,"sources":["scripts/components/Head/index.js","scripts/mobx/users.js","scripts/views/mine/index.js","scripts/components/uploadImg/index.js","assets/images/photo.png"],"names":["Item","Head","connect","goback","show","props","dispatch","changeTab","localStorage","oldTab","history","go","gotoSearch","push","this","search","login","scan","mode","icon","type","onLeftClick","rightContent","key","onClick","style","marginRight","Pop","title","Component","myImg","src","className","alt","handleVisibleChange","visible","setState","onSelect","obj","console","log","value","showActionSheet","BUTTONS","showActionSheetWithOptions","options","cancelButtonIndex","length","destructiveButtonIndex","message","maskClosable","wrapProps","onTouchStart","e","preventDefault","buttonIndex","state","mask","overlayClassName","overlayStyle","color","overlay","data-seed","whiteSpace","align","overflow","adjustY","adjustX","offset","onVisibleChange","height","padding","display","alignItems","User","observable","isLogin","action","userInfo","Mine","banner","getIn","user","get","observer","todoLogin","autoplay","sessionStorage","token","getBannerAsync","url","params","limit","users","width","inline","infinite","autoplayInterval","beforeChange","from","to","afterChangtruncateSync","map","b","i","href","images","large","verticalAlign","onLoad","window","dispatchEvent","Event","UploadImg","handleClick","inp","click","upload","file","files","data","FormData","append","axios","method","contentType","processData","then","res","code","pic","replace","changeUserInfo","post","result","require","ref","el","onChange","module","exports"],"mappings":"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","file":"static/js/17.2016db4f.chunk.js","sourcesContent":["\r\n\r\nimport \"./index.scss\"\r\n\r\nimport {NavBar,Icon,Popover,ActionSheet} from \"antd-mobile\"\r\nconst Item = Popover.Item;\r\n\r\nimport {history} from \"&/history\";\r\n\r\nimport {bus} from \"&\"\r\n\r\nimport {connect} from \"react-redux\"\r\nimport { changeTab } from \"../../actions\";\r\n\r\n\r\n@connect()\r\nexport default class Head extends Component{\r\n    goback=(show)=>{\r\n        if(show){\r\n            // bus.emit(\"changeTab\",localStorage.oldTab);\r\n            this.props.dispatch(changeTab(localStorage.oldTab))\r\n            history.go(-1);\r\n        }\r\n    }\r\n\r\n    gotoSearch=()=>{\r\n        history.push(\"/search\");\r\n    }\r\n\r\n    render(){\r\n        const {\r\n            show,\r\n            search,\r\n            login,\r\n            scan\r\n        }  = this.props;\r\n        return (\r\n            <NavBar\r\n            mode=\"dark\"\r\n            icon={show&&<Icon type=\"left\" />}\r\n            onLeftClick={ ()=>this.goback(show) }\r\n            rightContent={[\r\n             !search&&<Icon key=\"0\" onClick={this.gotoSearch} type=\"search\" style={{ marginRight: '16px' }} />,\r\n             <Pop key={1} login={login} scan={scan}/>     ,\r\n            ]}\r\n          > {this.props.title }</NavBar>\r\n        )\r\n    }\r\n}\r\n\r\nconst myImg = src => <img src={`https://gw.alipayobjects.com/zos/rmsportal/${src}.svg`} className=\"am-icon am-icon-xs\" alt=\"\" />;\r\nclass Pop extends Component{\r\n    constructor(){\r\n        super();\r\n        this.state = {\r\n            visible:false\r\n        }\r\n    }\r\n    handleVisibleChange=(visible)=>{\r\n        this.setState({\r\n            visible\r\n        })\r\n    }\r\n    onSelect=(obj)=>{\r\n        this.setState({\r\n            visible:false\r\n        });\r\n        console.log(obj);\r\n        const value = obj.props.value;\r\n        if(value==\"scan\"){\r\n            history.push(\"/scan\");\r\n        }else if (value==\"login\"){\r\n            history.push(\"/login\");\r\n        }else {\r\n            this.showActionSheet();\r\n        }\r\n    }\r\n\r\n    showActionSheet = () => {\r\n        const BUTTONS = ['拍摄', '从手机相册选择','删除',\"取消\"];\r\n        ActionSheet.showActionSheetWithOptions({\r\n          options: BUTTONS,\r\n          cancelButtonIndex: BUTTONS.length - 1,\r\n          destructiveButtonIndex: BUTTONS.length - 2,\r\n          // title: 'title',\r\n          message: 'wh1906',\r\n          maskClosable: true,\r\n          'data-seed': 'logId',\r\n          wrapProps:{\r\n            onTouchStart: e => e.preventDefault(),\r\n          },\r\n        },\r\n        (buttonIndex) => {\r\n            console.log(buttonIndex)\r\n        });\r\n    }\r\n\r\n    render(){\r\n        const {\r\n            login,\r\n            scan\r\n        } = this.props;\r\n        return (\r\n            <Popover \r\n                mask\r\n                overlayClassName=\"fortest\"\r\n                overlayStyle={{ color: 'currentColor' }}\r\n                visible={this.state.visible}\r\n                overlay={[\r\n                (!scan&&<Item key=\"4\" value=\"scan\" icon={myImg('tOtXhkIWzwotgGSeptou')} data-seed=\"logId\">扫一扫</Item>),\r\n                (<Item key=\"5\" value=\"photo\" icon={myImg('PKAgAqZWJVNwKsAJSmXd')} style={{ whiteSpace: 'nowrap' }}>拍照</Item>),\r\n                (!login&&<Item key=\"6\" value=\"login\" icon={myImg('uQIYTFeRrjPELImDRrPt')}>\r\n                    <span style={{ marginRight: 5 }}>登录</span>\r\n                </Item>),\r\n                ]}\r\n                align={{\r\n                overflow: { adjustY: 0, adjustX: 0 },\r\n                offset: [-10, 0],\r\n                }}\r\n                onVisibleChange={this.handleVisibleChange}\r\n                onSelect={this.onSelect}\r\n            >\r\n                <div style={{\r\n                height: '100%',\r\n                padding: '0 15px',\r\n                marginRight: '-15px',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                }}\r\n                >\r\n                <Icon  type=\"ellipsis\" />\r\n                </div>\r\n            </Popover>\r\n        )\r\n    }\r\n}","\r\nimport {observable,action,computed,autorun }  from \"mobx\"\r\n\r\nclass User{\r\n    @observable userInfo = {\r\n        isLogin:false\r\n    }\r\n\r\n    @action changeUserInfo=obj=>{\r\n        this.userInfo = {...this.userInfo,...obj};\r\n    }\r\n}\r\n\r\nexport default new User()","\r\n\r\n\r\n\r\nimport \"./index.scss\"\r\nimport Head  from \"~/components/Head\"\r\n\r\nimport UploadImg from \"~/components/uploadImg\";\r\n\r\nimport {axios} from \"&\";\r\n\r\nimport {WingBlank,Carousel,Button} from \"antd-mobile\"\r\n\r\n\r\nimport {history} from \"&/history\"\r\n\r\nimport {connect} from \"react-redux\"\r\nimport { getBannerAsync } from \"../../actions\";\r\nimport users from \"~/mobx/users\"\r\nimport {observer} from \"mobx-react\"\r\n@connect(\r\n    state=>({\r\n        banner:state.getIn(['data','banner']),\r\n        user:state.get(\"user\")\r\n    })\r\n)\r\n\r\n@observer\r\nexport default class Mine extends Component{\r\n    constructor(){\r\n        super();\r\n        this.state = {\r\n            // banner:[],\r\n            autoplay:true,\r\n            isLogin:sessionStorage.token\r\n        }\r\n    }\r\n\r\n    componentDidMount(){\r\n        // axios.get(\"/vue/movie\",{params:{limit:6}}).then(res=>{\r\n        //     this.setState({\r\n        //         banner:res.data.result\r\n        //     })\r\n        // })\r\n\r\n        if(!this.props.banner.length){\r\n            console.log(\"init\");\r\n            this.props.dispatch(getBannerAsync({\r\n                url:\"/vue/movie\",\r\n                params:{\r\n                    limit:8\r\n                }\r\n            }))\r\n        }\r\n    }\r\n\r\n    todoLogin=()=>{\r\n        history.push(\"/login\")\r\n    }\r\n\r\n    render(){\r\n        const {\r\n            isLogin\r\n        }  = this.state;\r\n\r\n        const {\r\n            user\r\n        } = this.props;\r\n        const {\r\n            userInfo\r\n        } = users;\r\n\r\n\r\n        return (\r\n            <div className=\"indexview\">\r\n                <Head title=\"个人中心\"></Head>\r\n                <div style={{display:isLogin?\"block\":\"none\"}}>\r\n                    <h2>Mine 个人中心 ....  {user.get(\"mobile\") }  </h2>\r\n                    <h2> token === {sessionStorage.token}</h2>\r\n                    <h2>token 2----- {userInfo.token}  </h2> \r\n                    <h2> <img style={{width:50,height:50}} src={user.get(\"pic\")}  alt=\"\"/></h2>\r\n                    <UploadImg></UploadImg>\r\n                </div>\r\n                <div  style={{display:!isLogin?\"block\":\"none\"}}>\r\n                    <h2>你还没有登录, 请马上登录 <Button onClick={this.todoLogin} inline type=\"primary\"> 前往登陆 </Button></h2>\r\n                </div>\r\n                <WingBlank>\r\n                    <Carousel\r\n                         autoplay={this.state.autoplay}\r\n                         infinite\r\n                         autoplayInterval={1500}\r\n                         beforeChange={(from, to) => console.log(`slide from ${from} to ${to}`)}\r\n                         afterChangtruncateSync\r\n                    >\r\n                        {\r\n                            this.props.banner.map((b,i)=>{\r\n                                return (\r\n                                    <a\r\n                                        key={i}\r\n                                        href=\"#/index/home\"\r\n                                        style={{ display: 'inline-block', width: '100%', height: 300 }}\r\n                                        >\r\n                                        <img\r\n                                            src={b.images.large}\r\n                                            alt=\"\"\r\n                                            style={{ width: '100%', verticalAlign: 'top',height: 300  }}\r\n                                            onLoad={() => {\r\n                                            // fire window resize event to change height\r\n                                                window.dispatchEvent(new Event('resize'));\r\n                                            \r\n                                            }}\r\n                                        />\r\n                                    </a>\r\n                                )\r\n                            })\r\n                        }\r\n                    </Carousel>\r\n                </WingBlank>\r\n            </div>\r\n        )\r\n    }\r\n}","\r\n\r\n\r\nimport \"./index.scss\";\r\nimport {axios} from \"&\"\r\n\r\nimport {connect} from \"react-redux\"\r\nimport { changeUserInfo } from \"../../actions\";\r\n\r\n@connect()\r\nexport default class UploadImg extends Component{\r\n\r\n    constructor(){\r\n        super();\r\n        this.state = {\r\n            pic:\"\"\r\n        }\r\n    }\r\n\r\n    componentDidMount(){\r\n        axios.post(\"/react/getAvatar\").then(res=>{\r\n            if(!!res.data.type){\r\n                this.setState({\r\n                    pic:res.data.result.pic.replace(/public/,\"https://peng47.com:2906/\")\r\n                });\r\n            }else{\r\n                this.setState({\r\n                    pic:require(\"@/assets/images/photo.png\")\r\n                })\r\n            }\r\n        })\r\n    }\r\n\r\n    handleClick=()=>{\r\n        this.inp.click();\r\n    }\r\n\r\n    upload=()=>{\r\n        console.log(\"马上上传图片....\");\r\n        const file = this.inp.files[0];\r\n        const data = new FormData();\r\n        data.append(\"avatar\",file);\r\n        axios({\r\n            url:\"/react/uploadreact\",\r\n            method:\"POST\",\r\n            data:data,\r\n            contentType:false,\r\n            processData:false,\r\n        }).then(res=>{\r\n            if(res.data.code==200){\r\n                this.setState({\r\n                    pic:res.data.pic.replace(/public/,\"https://peng47.com:2906/\")\r\n                });\r\n                this.props.dispatch(changeUserInfo({\r\n                    pic:res.data.pic.replace(/public/,\"https://peng47.com:2906/\")\r\n                }))\r\n            }\r\n        });\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div>\r\n                <img src={this.state.pic} alt=\"\" onClick={this.handleClick} className=\"touxiang\"/>\r\n                <input ref={el=>this.inp=el} style={{display:'none'}} onChange={this.upload} type=\"file\"/>\r\n            </div>\r\n        )\r\n    }\r\n}","module.exports = __webpack_public_path__ + \"static/media/photo.00e3a0e6.png\";"],"sourceRoot":""}